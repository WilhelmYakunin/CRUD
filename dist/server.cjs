(()=>{var e={371:(e,n,t)=>{t(738).config(Object.assign({},t(547),t(962)(process.argv)))},962:e=>{const n=/^dotenv_config_(encoding|path|debug|override)=(.+)$/;e.exports=function(e){return e.reduce((function(e,t){const r=t.match(n);return r&&(e[r[1]]=r[2]),e}),{})}},547:e=>{const n={};null!=process.env.DOTENV_CONFIG_ENCODING&&(n.encoding=process.env.DOTENV_CONFIG_ENCODING),null!=process.env.DOTENV_CONFIG_PATH&&(n.path=process.env.DOTENV_CONFIG_PATH),null!=process.env.DOTENV_CONFIG_DEBUG&&(n.debug=process.env.DOTENV_CONFIG_DEBUG),null!=process.env.DOTENV_CONFIG_OVERRIDE&&(n.override=process.env.DOTENV_CONFIG_OVERRIDE),e.exports=n},738:(e,n,t)=>{const r=t(147),s=t(17),i=t(37),o=/(?:^|^)\s*(?:export\s+)?([\w.-]+)(?:\s*=\s*?|:\s+?)(\s*'(?:\\'|[^'])*'|\s*"(?:\\"|[^"])*"|\s*`(?:\\`|[^`])*`|[^#\r\n]+)?\s*(?:#.*)?(?:$|$)/gm;function u(e){console.log(`[dotenv][DEBUG] ${e}`)}const a={config:function(e){let n=s.resolve(process.cwd(),".env"),t="utf8";const o=Boolean(e&&e.debug),c=Boolean(e&&e.override);var l;e&&(null!=e.path&&(n="~"===(l=e.path)[0]?s.join(i.homedir(),l.slice(1)):l),null!=e.encoding&&(t=e.encoding));try{const e=a.parse(r.readFileSync(n,{encoding:t}));return Object.keys(e).forEach((function(n){Object.prototype.hasOwnProperty.call(process.env,n)?(!0===c&&(process.env[n]=e[n]),o&&u(!0===c?`"${n}" is already defined in \`process.env\` and WAS overwritten`:`"${n}" is already defined in \`process.env\` and was NOT overwritten`)):process.env[n]=e[n]})),{parsed:e}}catch(e){return o&&u(`Failed to load ${n} ${e.message}`),{error:e}}},parse:function(e){const n={};let t,r=e.toString();for(r=r.replace(/\r\n?/gm,"\n");null!=(t=o.exec(r));){const e=t[1];let r=t[2]||"";r=r.trim();const s=r[0];r=r.replace(/^(['"`])([\s\S]*)\1$/gm,"$2"),'"'===s&&(r=r.replace(/\\n/g,"\n"),r=r.replace(/\\r/g,"\r")),n[e]=r}return n}};e.exports.config=a.config,e.exports.parse=a.parse,e.exports=a},147:e=>{"use strict";e.exports=require("fs")},37:e=>{"use strict";e.exports=require("os")},17:e=>{"use strict";e.exports=require("path")}},n={};function t(r){var s=n[r];if(void 0!==s)return s.exports;var i=n[r]={exports:{}};return e[r](i,i.exports,t),i.exports}t.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return t.d(n,{a:n}),n},t.d=(e,n)=>{for(var r in n)t.o(n,r)&&!t.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:n[r]})},t.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),(()=>{"use strict";const e=require("http");var n=t(17),r=t(147);const s={users:[],usersIDs:{count:0,ids:[]},paths:[]},i=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,o=function(e){return"string"==typeof e&&i.test(e)};var u=n.dirname(__filename);const a=function(e,n){return e<400||e>=600?{codeClass:"not http or server error",statusCode:e,message:n}:{codeClass:500===Number(String(e).charAt(0)+"00")?"Internal server error":"Bad Request",statusCode:e,message:n}},c=require("crypto");var l=t.n(c);const d={randomUUID:l().randomUUID},f=new Uint8Array(256);let p=f.length;function v(){return p>f.length-16&&(l().randomFillSync(f),p=0),f.slice(p,p+=16)}const h=[];for(let e=0;e<256;++e)h.push((e+256).toString(16).slice(1));const g=function(e,n,t){if(d.randomUUID&&!n&&!e)return d.randomUUID();const r=(e=e||{}).random||(e.rng||v)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,n){t=t||0;for(let e=0;e<16;++e)n[t+e]=r[e];return n}return function(e,n=0){return(h[e[n+0]]+h[e[n+1]]+h[e[n+2]]+h[e[n+3]]+"-"+h[e[n+4]]+h[e[n+5]]+"-"+h[e[n+6]]+h[e[n+7]]+"-"+h[e[n+8]]+h[e[n+9]]+"-"+h[e[n+10]]+h[e[n+11]]+h[e[n+12]]+h[e[n+13]]+h[e[n+14]]+h[e[n+15]]).toLowerCase()}(r)};var w=function(){return w=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var s in n=arguments[t])Object.prototype.hasOwnProperty.call(n,s)&&(e[s]=n[s]);return e},w.apply(this,arguments)};const y=function(e,t){var i=process.env,c=process.pid;i.port,process.send?e.headers=w(w({},e.headers),{host:"localhost:4040"}):console.log("pid: ".concat(c,": ").concat(e.method," ").concat(e.url));var l=e.method,d=e.url;switch(l){case"GET":!function(e,t){var i,c,l=e.lastIndexOf("/"),d=e.slice(l+1);switch(e){case"/":return i=n.join(u,"index.html"),(c=(0,r.createReadStream)(i)).on("data",(function(e){t.statusCode=200,t.write(e)})),void c.on("end",(function(){t.end()}));case"/api/users":return t.statusCode=200,t.write(JSON.stringify(s.users)),void t.end();default:(function(){if(!o(d)&&"/api/users"===e.slice(0,10)){t.statusCode=400;var n=a(400,"unknown type of the id ".concat(d," or url is incorect"));return t.write(JSON.stringify(n,null,2)),void t.end()}if(!s.paths.includes(e)&&"/api/users"!==e.slice(0,10))return function(){t.statusCode=404;var n=a(404,"page ".concat(e," not found"));t.write(JSON.stringify(n,null,2)),t.end()}();var r=s.users.find((function(e){return e.id===d}));if(!r)return t.statusCode=404,n=a(404,"user with the id ".concat(d," does not exist")),t.write(JSON.stringify(n,null,2)),void t.end();var i=s.users.findIndex((function(e){return e.id===d})),u=s.users.splice(i,1)[0];t.write(JSON.stringify(u,null,2)),t.end()})()}}(d,t);break;case"POST":!function(e,n){if("/api/users"!==e.url){n.statusCode=404;var t=a(404,"unknown url adress");return n.write(JSON.stringify(t,null,2)),void n.end()}var r="";e.on("data",(function(e){r+=e})).on("end",(function(){var e,t,i=[],o=r.split("&"),u=[];if(o.map((function(r){switch(r.split("=")[0]){case"username":return u.push("username"),e=r.split("=")[1];case"age":return u.push("age"),t=Number(r.split("=")[1]);case"hobbies":u.push("hobbies");var s=r.split("=")[1];return void(""!==s&&s.split("%2C").map((function(e){return i.push(e)})));default:n.statusCode=400;var o=a(400,"unknown input filed ".concat(r.split("=")[0]," with property ").concat(r.split("=")[1]));return n.write(JSON.stringify(o,null,2)),void n.end()}})),!Boolean(u.includes("username")&&u.includes("age")&&u.includes("hobbies"))){n.statusCode=400;var c=a(400,"input does not contain all required fields");return n.write(JSON.stringify(c,null,2)),n.end()}if(s.users.find((function(n){return n.username===e&&n.age===t})))return n.statusCode=400,c=a(400,"user already exist"),n.write(JSON.stringify(c,null,2)),n.end();var l,d={id:String((l=g(),s.usersIDs.count+=1,s.usersIDs.ids.push(l),l)),username:e,age:t,hobbies:Boolean(i)?i:[]};return s.users.push(d),s.paths.push("/api/users/"+d.id),n.statusCode=201,n.write(JSON.stringify(d)),n.end()}))}(e,t);break;case"PUT":!function(e,n){var t="";e.on("data",(function(e){t+=e})).on("end",(function(){var r,i,u=e.url.lastIndexOf("/"),c=e.url.slice(u+1);if(!o(c)){n.statusCode=400;var l=a(400,"unknown type of the id ".concat(c," or url is incorect"));return n.write(JSON.stringify(l,null,2)),void n.end()}if(!s.users.find((function(e){return e.id===c})))return n.statusCode=404,l=a(404,"user with the id ".concat(c," does not exist")),n.write(JSON.stringify(l,null,2)),void n.end();var d=[],f=t.split("&"),p=[];if(f.map((function(e){switch(e.split("=")[0]){case"username":return p.push("username"),r=e.split("=")[1];case"age":return p.push("age"),i=Number(e.split("=")[1]);case"hobbies":p.push("hobbies");var t=e.split("=")[1];return void(""!==t&&t.split("%2C").map((function(e){return d.push(e)})));default:n.statusCode=400;var s=a(400,"unknown input filed ".concat(e.split("=")[0]," with property ").concat(e.split("=")[1]));return n.write(JSON.stringify(s,null,2)),void n.end()}})),!Boolean(p.includes("username")&&p.includes("age")&&p.includes("hobbies")))return n.statusCode=400,l=a(400,"input does not contain all required fields"),n.write(JSON.stringify(l,null,2)),n.end();var v={username:r,age:i,hobbies:Boolean(d)?d:[]};s.users.map((function(e){e.id===c&&Object.assign(e,v)})),n.write(JSON.stringify(v)),n.end()}))}(e,t);break;case"DELETE":!function(e,n){e.on("data",(function(e){})).on("end",(function(){var t=e.url.lastIndexOf("/"),r=e.url.slice(t+1);if(!o(r)){n.statusCode=400;var i=a(400,"the id ".concat(r," is invalid or url is incorect"));return n.write(JSON.stringify(i,null,2)),void n.end()}if(!s.users.find((function(e){return e.id===r})))return n.statusCode=404,i=a(404,"user with the id ".concat(r," does not exist")),n.write(JSON.stringify(i,null,2)),void n.end();var u=s.users.findIndex((function(e){return e.id===r})),c=s.paths.findIndex((function(e){return e==="api/users/"+r}));s.users.splice(u,1),s.paths.splice(c,1),n.statusCode=204,n.write("the user with id: ".concat(r," deleted")),n.end()}))}(e,t);break;default:t.statusCode=500;var f=a(500,"somthing went wrong on server side method: ".concat(l," url: ").concat(d));return t.write(JSON.stringify(f,null,2)),t.end()}};t(371);var O=process.env,b=process.pid,m=O.port,N=e.createServer();N.listen(m,(function(){process.stdout.write("Server is running on port: ".concat(m," \npid is: ").concat(b," \n")),N.addListener("request",(function(e,n){return t=void 0,r=void 0,i=function(){return function(e,n){var t,r,s,i,o={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return i={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(i[Symbol.iterator]=function(){return this}),i;function u(i){return function(u){return function(i){if(t)throw new TypeError("Generator is already executing.");for(;o;)try{if(t=1,r&&(s=2&i[0]?r.return:i[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,i[1])).done)return s;switch(r=0,s&&(i=[2&i[0],s.value]),i[0]){case 0:case 1:s=i;break;case 4:return o.label++,{value:i[1],done:!1};case 5:o.label++,r=i[1],i=[0];continue;case 7:i=o.ops.pop(),o.trys.pop();continue;default:if(!((s=(s=o.trys).length>0&&s[s.length-1])||6!==i[0]&&2!==i[0])){o=0;continue}if(3===i[0]&&(!s||i[1]>s[0]&&i[1]<s[3])){o.label=i[1];break}if(6===i[0]&&o.label<s[1]){o.label=s[1],s=i;break}if(s&&o.label<s[2]){o.label=s[2],o.ops.push(i);break}s[2]&&o.ops.pop(),o.trys.pop();continue}i=n.call(e,o)}catch(e){i=[6,e],r=0}finally{t=s=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}([i,u])}}}(this,(function(t){switch(t.label){case 0:return[4,y(e,n)];case 1:return[2,t.sent()]}}))},new((s=void 0)||(s=Promise))((function(e,n){function o(e){try{a(i.next(e))}catch(e){n(e)}}function u(e){try{a(i.throw(e))}catch(e){n(e)}}function a(n){var t;n.done?e(n.value):(t=n.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,u)}a((i=i.apply(t,r||[])).next())}));var t,r,s,i}))}))})()})();
//# sourceMappingURL=server.cjs.map